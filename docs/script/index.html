<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <base href="/">
  <meta name="description" content="Lightweight script loader for lazy loading ES modules and ES5 scripts or both based on dynamic paths">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FicusJS script loader documentation</title>
  <link rel="stylesheet" href="css/doc.css">
  <link rel="apple-touch-icon" sizes="57x57" href="img/favicons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="img/favicons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="img/favicons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="img/favicons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="img/favicons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="img/favicons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="img/favicons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="img/favicons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="img/favicons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="img/favicons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="img/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="img/favicons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="img/favicons/favicon-16x16.png">
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="img/favicons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<svg style="position:absolute;height:0;width:0;">
  <symbol id="icon_home" viewBox="0 0 32 32">
    <g>
      <path d="M 16 2.59375 L 15.28125 3.28125 L 2.28125 16.28125 L 3.71875 17.71875 L 5 16.4375 L 5 28 L 14 28 L 14 18 L 18 18 L 18 28 L 27 28 L 27 16.4375 L 28.28125 17.71875 L 29.71875 16.28125 L 16.71875 3.28125 Z M 16 5.4375 L 25 14.4375 L 25 26 L 20 26 L 20 16 L 12 16 L 12 26 L 7 26 L 7 14.4375 Z "></path>
    </g>
  </symbol>
  <symbol id="icon_github" viewBox="0 0 32 32">
    <g>
      <path d="M 16 4 C 9.371094 4 4 9.371094 4 16 C 4 21.300781 7.4375 25.800781 12.207031 27.386719 C 12.808594 27.496094 13.027344 27.128906 13.027344 26.808594 C 13.027344 26.523438 13.015625 25.769531 13.011719 24.769531 C 9.671875 25.492188 8.96875 23.160156 8.96875 23.160156 C 8.421875 21.773438 7.636719 21.402344 7.636719 21.402344 C 6.546875 20.660156 7.71875 20.675781 7.71875 20.675781 C 8.921875 20.761719 9.554688 21.910156 9.554688 21.910156 C 10.625 23.746094 12.363281 23.214844 13.046875 22.910156 C 13.15625 22.132813 13.46875 21.605469 13.808594 21.304688 C 11.144531 21.003906 8.34375 19.972656 8.34375 15.375 C 8.34375 14.0625 8.8125 12.992188 9.578125 12.152344 C 9.457031 11.851563 9.042969 10.628906 9.695313 8.976563 C 9.695313 8.976563 10.703125 8.65625 12.996094 10.207031 C 13.953125 9.941406 14.980469 9.808594 16 9.804688 C 17.019531 9.808594 18.046875 9.941406 19.003906 10.207031 C 21.296875 8.65625 22.300781 8.976563 22.300781 8.976563 C 22.957031 10.628906 22.546875 11.851563 22.421875 12.152344 C 23.191406 12.992188 23.652344 14.0625 23.652344 15.375 C 23.652344 19.984375 20.847656 20.996094 18.175781 21.296875 C 18.605469 21.664063 18.988281 22.398438 18.988281 23.515625 C 18.988281 25.121094 18.976563 26.414063 18.976563 26.808594 C 18.976563 27.128906 19.191406 27.503906 19.800781 27.386719 C 24.566406 25.796875 28 21.300781 28 16 C 28 9.371094 22.628906 4 16 4 Z "></path>
    </g>
  </symbol>
</svg>
<div class="doc__bg"></div>
<nav class="header">
  <div class="wrapper">
    <div class="logo">FicusJS script loader <span class="logo__thin">Doc</span></div>
    <ul class="menu">
      <li class="menu__item toggle"><span></span></li>
      <li class="menu__item"><a href="https://github.com/ducksoupdev/ficusjs-script" target="_blank" rel="noopener noreferrer" class="link link--dark"><svg class="icon"><use xlink:href="#icon_github" /></svg> Github</a></li>
      <li class="menu__item"><a href="index.html" class="link link--dark"><svg class="icon"><use xlink:href="#icon_home" /></svg> Home</a></li>
    </ul>
  </div>
</nav>
<div class="wrapper">
  <div class="wrapper__content">
    <aside class="doc__nav">
      <ul>
        <li class=""><a href="docs/getting-started" class="doc__nav-item">Getting started</a></li>
        <li class=""><a href="docs/installation" class="doc__nav-item">Installation</a></li>
        <li class=""><a href="docs/features" class="doc__nav-item">Features</a></li>
        <li class=""><a href="docs/script" class="doc__nav-item">Script loader</a></li>
        <li class=""><a href="docs/browser-support" class="doc__nav-item">Browser support</a></li>
        <li class=""><a href="docs/going-build-less" class="doc__nav-item">Going build-less</a></li>
        <li class=""><a href="https://github.com/ducksoupdev/ficusjs-script/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="doc__nav-item">Changelog</a></li>
        <li class=""><a href="docs/ficusjs" class="doc__nav-item">FicusJS</a></li>
      </ul>    </aside>
    <article class="doc__content">
      <h1>Script loader</h1>
<p>For lazy loading ES6 modules and ES5 scripts or both based on dynamic paths.</p>
<h2>Third-party libraries</h2>
<p>There is a wealth of libraries available via CDNs and NPM packages.</p>
<h3>NPM packages</h3>
<p>NPM is a package manager primarily used for NodeJS. However, it is commonly used to distribute packages that work across environments - NodeJS and browsers.</p>
<p>It is important to check if a particular package is compatible with browsers. ES5 and ES6 libraries are often distributed for browser use alongside NodeJS.</p>
<p>You can use a package within the browser by loading the file it distributes by copying it to a path the browser can access.
Alternatively, you can use the NPM package CDN named <a href="https://unpkg.com/">Unpkg</a>. <a href="https://unpkg.com/">Unpkg</a> is a fast, CDN for everything on NPM. Use it to quickly and easily load any file from any package using a URL like <code>unpkg.com/:package@:version/:file</code></p>
<p>To use the <a href="https://www.npmjs.com/package/marked">marked</a> package which provides an ES6 module:</p>
<pre><code class="language-js">import { loadScript } from 'https://cdn.skypack.dev/@ficusjs/script'

// ES6 module - uses *.esm.js file name convention
// this script won't load if ES6 is not supported
loadScript('https://unpkg.com/marked@1.1.1/lib/marked.esm.js')

// // ES6 module - uses explicit type: 'module'
// this script won't load if ES6 is not supported
loadScript({
  url: 'https://unpkg.com/marked@1.1.1/lib/marked.esm.js',
  type: 'module'
})
</code></pre>
<p>To use the <a href="https://www.npmjs.com/package/marked">marked</a> package which provides an ES5 script:</p>
<pre><code class="language-js">loadScript('https://unpkg.com/marked@1.1.1/marked.min.js')
</code></pre>
<h2>How to load scripts</h2>
<p>Lazy loading scripts can be used with the <a href="https://router.ficusjs.org/">FicusJS script loader</a> where dynamic loading of views and outlets is needed.</p>
<h3><code>loadScript</code> function</h3>
<p>Using a native ES6 import <code>import()</code> to resolve a script, only works with static strings. If you want to use dynamic paths to scripts based on configuration,
the <code>loadScript</code> function can load ES6 modules, ES5 scripts or both.</p>
<p>You can load single or multiple scripts.</p>
<pre><code class="language-js">import { loadScript } from 'https://cdn.skypack.dev/@ficusjs/script'

// load single script
loadScript('/js/script1.esm.js')

// load multiple scripts
loadScript(
  '/js/script1.esm.js', // ES6 module - uses *.esm.js file name convention - won't load if ES6 is not supported
  { url: '/js/script1.es.js', type: 'module' }, // ES6 module - uses explicit type:module - won't load if ES6 is not supported
  '/js/script1.js', // ES5 script
  [
    '/js/script2.esm.js', // ES6 module - uses *.esm.js file name convention
    '/js/script2.iife.js' // ES5 script - fallback if ES6 is not supported
  ],
  [
    { url: '/js/script3.es.js', type: 'module' }, // ES6 module - uses explicit type:module
    { url: '/js/script3.iife.js', cache: false } // ES5 script with cache disabled - fallback if ES6 is not supported
  ]
)
</code></pre>
<h4>Router example</h4>
<p>An example of using <code>loadScript</code> in a route.</p>
<pre><code class="language-js">import { loadScript } from 'https://cdn.skypack.dev/@ficusjs/script'
import { createRouter } from 'https://cdn.skypack.dev/@ficusjs/router'

// use the loadScript to load an ES6 module for a route
{
  path: '',
  action () {
    const pathToLoad = './views/home.esm.js' // some dynamic path
    return loadScript(pathToLoad).then(() =&gt; `home-page`)
  }
}
</code></pre>
<h4>ES6 modules</h4>
<p>Using the <code>loadScript</code> function to load ES6 modules can be done in two ways:</p>
<ol>
<li>Using file name convention of <code>*.esm.js</code></li>
<li>Using an object to specify the type is module and optionally disable caching</li>
</ol>
<p>Loading ES6 modules is used to import bindings which are exported by the module.</p>
<pre><code class="language-js">import { loadScript } from 'https://cdn.skypack.dev/@ficusjs/script'

// using the file name convention of *.esm.js
loadScript('./views/home.esm.js')
  .then(mod =&gt; {
    // access the exported named module binding
    console.log(mod.myExportedVariable)

    // access the default exported binding
    console.log(mod.default)
  })

// using an object to specify the type is module
loadScript({ url: './views/home.js', type: 'module' })
  .then(({ myExportedVariable }) =&gt; {
    // access the exported named module binding
    console.log(myExportedVariable)
  })

// using an object to specify the type is module and disabling the caching of the script
loadScript({ url: './views/home.js', type: 'module', cache: false })
  .then(mod =&gt; {
    // access the default exported binding
    console.log(mod.default)
  })

// loading multiple scripts
loadScript(
  './views/home.esm.js',
  './views/profile.esm.js',
  './views/list.esm.js',
)
  .then(mods =&gt; {
    // access the exported named module binding from home.esm.js
    console.log(mods[0].myExportedVariable)

    // access the exported named module binding from profile.esm.js
    console.log(mods[1].myExportedVariable)

    // access the exported named module binding from list.esm.js
    console.log(mods[2].myExportedVariable)
  })

// using the await keyword
let module = await loadScript('./views/home.esm.js')
</code></pre>
<h4>ES6 modules with ES5 fallback for older browsers</h4>
<p>Using the <code>loadScript</code> function to load ES6 modules with an ES5 fallback will detect if the browser supports ES6 and then automatically fallback to loading the ES5 script if not supported.</p>
<p>To use this feature, you need to pass a two-item <code>Array</code> - the first item is the ES6 module and the second item is the ES5 fallback script:</p>
<pre><code class="language-js">import { loadScript } from 'https://cdn.skypack.dev/@ficusjs/script'

// load scripts based on file names
loadScript(
  [
    '/views/home.esm.js', // ES6 module - uses *.esm.js file name convention
    '/views/home.iife.js' // ES5 script - fallback if ES6 is not supported
  ]
)
  .then(mod =&gt; {
    // access the exported named module variables
    console.log(mod.myExportedVariable)

    // access the default exported variable
    console.log(mod.default)
  })

// load scripts based on objects
loadScript(
  [
    { url: '/views/home.js', type: 'module' }, // ES6 module - uses explicit type of module
    { url: '/views/home.iife.js', cache: false } // ES5 script with cache disabled - fallback if ES6 is not supported
  ]
)
  .then(mod =&gt; {
    // access the exported named module variables
    console.log(mod.myExportedVariable)

    // access the default exported variable
    console.log(mod.default)
  })

// using the await keyword
let module = await loadScript(
  [
    '/views/home.esm.js', // ES6 module - uses *.esm.js file name convention
    '/views/home.iife.js' // ES5 script - fallback if ES6 is not supported
  ]
)
</code></pre>
<h4>ES5 scripts</h4>
<p>Using the <code>loadScript</code> function to load ES5 scripts can be done in two ways:</p>
<ol>
<li>Using the path to the script</li>
<li>Using an object to optionally disable caching</li>
</ol>
<pre><code class="language-js">import { loadScript } from 'https://cdn.skypack.dev/@ficusjs/script'

// using the file name convention of *.esm.js
loadScript('./views/home.iife.js')

// using an object to disable the caching of the script
loadScript({ url: './views/home.iife.js', cache: false })
</code></pre>

    </article>
  </div>
</div>
<a href="#" class="cd-top text-replace"></a>

<script src="js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="module" src="js/scribbler.js"></script>
<script src="js/service-worker.js"></script>
</body>
</html>
